import{c as h}from"./call-bind-CkPzBTRv.js";var f={},d={};Object.defineProperty(d,"__esModule",{value:!0});d.MiniSignal=void 0;const _=Symbol("SIGNAL");function u(a){return typeof a=="object"&&_ in a}class o{constructor(){this._symbol=Symbol("MiniSignal"),this._refMap=new WeakMap,this._head=void 0,this._tail=void 0,this._dispatching=!1}hasListeners(){return this._head!=null}dispatch(...e){if(this._dispatching)throw new Error("MiniSignal#dispatch(): Signal already dispatching.");let i=this._head;if(i==null)return!1;for(this._dispatching=!0;i!=null;)i.fn(...e),i=i.next;return this._dispatching=!1,!0}add(e){if(typeof e!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return this._createRef(this._addNode({fn:e}))}detach(e){if(!u(e))throw new Error("MiniSignal#detach(): First arg must be a MiniSignal listener reference.");if(e[_]!==this._symbol)throw new Error("MiniSignal#detach(): MiniSignal listener does not belong to this MiniSignal.");const i=this._refMap.get(e);return i?(this._refMap.delete(e),this._disconnectNode(i),this._destroyNode(i),this):this}detachAll(){let e=this._head;if(e==null)return this;for(this._head=this._tail=void 0,this._refMap=new WeakMap;e!=null;)this._destroyNode(e),e=e.next;return this}_destroyNode(e){e.fn=void 0,e.prev=void 0}_disconnectNode(e){e===this._head?(this._head=e.next,e.next==null&&(this._tail=void 0)):e===this._tail&&(this._tail=e.prev,this._tail!=null&&(this._tail.next=void 0)),e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev)}_addNode(e){return this._head==null?(this._head=e,this._tail=e):(this._tail.next=e,e.prev=this._tail,this._tail=e),e}_createRef(e){const i={[_]:this._symbol};return this._refMap.set(i,e),i}_getRef(e){return this._refMap.get(e)}}d.MiniSignal=o;(function(a){var e=h&&h.__createBinding||(Object.create?function(s,n,t,r){r===void 0&&(r=t);var l=Object.getOwnPropertyDescriptor(n,t);(!l||("get"in l?!n.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(s,r,l)}:function(s,n,t,r){r===void 0&&(r=t),s[r]=n[t]}),i=h&&h.__exportStar||function(s,n){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(n,t)&&e(n,s,t)};Object.defineProperty(a,"__esModule",{value:!0}),i(d,a)})(f);export{f as d};
